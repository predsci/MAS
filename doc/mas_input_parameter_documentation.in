!
! ### INPUT PARAMETER OPTIONS FOR MAS ###
! ### THIS FILE IS A VALID INPUT FILE WITH CODE DEFAULTS ###
! ### Note that this file is a work-in-progress and does not
! ### currently cover all input parameters.
!
! ### DOC Version: 0.1.0    MAS Version: 0.9.3.0
!
!
! *** Grid resolution.
!
&topology
  nr = 61                                                ! Grid resolution in the `r` direction.

  nt = 31                                                ! Grid resolution in the `theta` direction.

  np = 61                                                ! Grid resolution in the `phi` direction.
/
&data

  legacy_output_filenames = .false.                      ! Set to true to use the old-style file output.

  r0 = 1.0                                               ! Coordinate of the lower radial boundary.

  r1 = 30.0                                              ! Coordinate of the upper radial boundary.

  tmax = 0.5                                             ! End time of the simulation in MAS time units.

  rfrac    = 0.0,1.0                                     ! Normalized positions of grid segment boundaries
                                                         ! (as a fraction of domain size) for radial grid.

  drratio  = 1.0                                         ! Ratio of grid spacing at the end of each segment to that
                                                         ! at the beginning for the radial grid
                                                         ! [ length(drratio) = length(rfrac)-1 ].

  nfrmesh  = 5                                           ! Number of times to filter/smooth the radial grid spacing.

  tfrac    = 0.0,1.0                                     ! Same as rfrac but for theta grid.

  dtratio  = 1.0                                         ! Same as drratio but for theta grid.

  nftmesh  = 5                                           ! Same as nfrmesh but for theta grid.

  pfrac    = 0.0                                         ! Same as rfrac but for phi grid.  
                                                         ! Here there is one less value due to periodic boundary.

  dpratio  = 1.0                                         ! Same as drratio but for phi grid. 
                                                         ! Here, length(dpratio) = length(pfrac).

  nfpmesh  = 5                                           ! Same as nfrmesh but for phi grid.

  phishift = 0.0                                         ! Apply an optional phi shift (radians) to the input phi grid.

  dtmax = 0.01                                           ! Maximum allowed time step.  
                                                         ! Will be first time step to try unless dt_init is set.

  dtmin = 1.e-5                                          ! Minimum allowed time step.  If time step drops below this, 
                                                         ! a warning is issued.

  dt_init = 0.005                                        ! Initial time step to use unless stability requires it lower.

  dt_max_wave_cfl = 1000.0                               ! Limit the time step to dt_max_wave_cfl times 
                                                         ! larger than the wave CFL limit.              

  plotlist = 'zp'                                        ! List of 3D quantities to output.

  ipltxint = 2
  tpltxint = 0.0

  slice_plotlist = 'rho'                                 ! List of 2D theta-phi slice quantities to output.

  slice_tp_radii = 10.0
  slice_ixint = 1
  slice_txint = 0.0
  trace_txint = 0.0

  hdf32 = .false.                                      ! Output hdf5 precision:
                                                       !   .true.   Single-precision (32-bit) output.
                                                       !   .false.  Double-precision (64-bit) output.

  rs_final = .false.
  trsdump = 0.0
  advance_a    = .true.
  advance_v    = .true.
  advance_t    = .true.
  advance_rho  = .true.
  advance_pw   = .false.
  advance_zw   = .true.
  advance_fcs  = .false.
  trace_particles = .false.
  slund = 1.e5
  visc = .002
  gamma = 1.666666666666667
  g0 = 0.823
  br00 = 0.0
  rho0 = 40000.0
  tbc0 = 17500.0
  tchromo = 17500.0
  iftfloor = .true.
  tfloor = 10000.0
  char_bc0 = .true.
  char_bc1 = .true.
  rhobc_maxfac_r1 = 0.1
  ifrholimit = .true.
  rho_limit_factor = 0.007
  rho_limit_file = 'rho3d_initial_1au_rho40k.h5'
  max_alfven_speed_rho_mod = 100.0
  ubzero = .false.
  filter_poles = .true.
  advance_tc = .true.
  tcond = 1.0
  t_cutoff1 = 400000.0
  nfilt_kappa = 0
  alpha_nocoll = 1.0
  tc_r = 10.0
  tc_dr = 1.0
  tc_fac0 = 1.0
  tc_fac1 = 0.0
  tc_nocoll_r = 10.0
  tc_nocoll_dr = 1.0
  radloss = 1.0
  rad_law = 'CHIANTI_v713_HYBRID'
  heatsource(1)%active = .true.
  heatsource(1)%name = 'NL'
  heatsource(1)%use_mask = .false.
  heatsource(1)%type = 'exponential-b-photo-dependent'
  heatsource(1)%nl_mask = .true.
  heatsource(1)%h0 = 0.10
  heatsource(1)%lambda = 0.03
  heatsource(1)%power = 1.00
  heatsource(1)%b_profile%active = .false.
  heatsource(1)%b_attenuation = .false.
  heatsource(1)%r_profile%active = .false.
  heatsource(1)%t_profile%active = .false.
  heating_flat_topped = .false.
  heat_mask_file = ' '
  add_ohmic_heating = .false.
  wtd_z0 = 0.02
  wtd_b0 = 3.86834
  wtd_lambda0 = 0.02
  wtd_use_zw_flux_mask = .true.
  z0_flux_mask_tp_file = 'wtd_flux_mask_tp.h5'
  zw_dissp = .true.
  zw_reflection = .true.
  wtd_add_zw_heating = .true.
  wtd_add_zw_pressure = .false.
  zw_uwc_s = 0.0
  zw_uwc_z = 1.0
  wtd_use_flux_limiter_gradzw = .true.
  wtd_use_flux_limiter_gradsrc = .false.
  zw_flux_limiter_type = 'ospre'
  zw_cfl = 0.9
  wtd_use_zw_limit = .true.
  zw_limit_amplitude = 1.6
  zw_limit_radial_file = 'zw_limit_test01.dat'
  zw_rho_aw = 3.0
  wtd_bc_extrap_fac_r1 = 0.1
  wtd_use_zw_effective_rho_limit = .true.
  zw_effective_rho_limit_lr = 2.20412
  zw_effective_rho_limit_lw = 0.3
  wtd_use_zw_horho_limit = .true.
  zw_horho_limit_rlim = 8.0
  zw_horho_limit_value = 5.e-2
  use_chromo_heat = .true.
  chromo_heat_t_zqc_0 = 10000.0
  chromo_heat_t_zqc_1 = 40000.0
  tprofile(2)%t = 0.0,1.0
  tprofile(2)%f = 1.0,1.0
  tprofile(2)%vars = 'zw_heat_factor'
  tprofile(3)%t = 0.0,1.0
  tprofile(3)%f = 1.0,1.0
  tprofile(3)%vars = 'zw_pressure_factor'
  wtd_icond = 'WKB_BR'
  wtd_icfac = 1.0

  initial_field = 'POTENTIAL_FIELD' ! Initial field.  Choices are:
                                    !   DIPOLE                 Global and subsurface dipoles.
                                    !   POTENTIAL_FIELD        Potential field based on input map.
                                    !   ALFVEN_WAVE1           Analytic Alfven wave in theta.
                                    !   ALFVEN_WAVE2           Analytic Alfven wave in phi.
                                    !   ALFVEN_WAVE2_ROTATED   Same as WAVE2 but tilted.
                                    !   A_FILE                 Read in initial vector potential.

  bnfile = 'br_input.h5'            ! Filename (HDF5) of the input 2D (theta,phi) Br magnetic field at r0.

  b_in_gauss = .true.               ! Set to true if the bnfile is in units of Gauss, otherwise code assumes MAS units.

  initial_plasma = '1dfile'         ! Initial plasma.  Choices are:
                                    !   ZERO-BETA              
                                    !   STREAMER
                                    !   HYDROSTATIC
                                    !   1DFILE         Use onedfile text file to describe spherically symmetric initial plasma
                                    !   2DFILE         Use 2D file (in r-theta) for axisymmetric initial conditions.
                                    !   NONE

  onedfile = 'initial_plasma_1d_r_rho40k.dat'  ! Name of text file describing the initial plasma.
                                               ! Must be of the form:
                                               ! 

  cfl = 0.4
  use_sts_visc = .true.
  use_sts_tc   = .true.
  visc_auto_subcycle = .true.
  tc_auto_subcycle   = .true.
  ifimplrad = 0

  ifprec_t     = 3                   ! Preconditioner method for the thermal conduction solves:
                                     !   1    Diagonal (recommended for heliospheric CPU runs, and/or GPU runs)
                                     !   2    SGS      (available for CPU runs)
                                     !   3    ILUB0    (recommended for CPU runs)

  ifprec_v     = 3                   ! Preconditioner method for the velocity solves (see above).

  ifprec_pot2d = 3                   ! Preconditioner method for the boundary potential solves.

  ifprec_divb  = 3                   ! Preconditioner method for the remesh divergence cleaning solve.

  epscg_a       = 1.e-9              ! Solver (resistivity) convergence tolerance, |residual|/|right-hand-side|.

  epscg_v       = 1.e-9              ! Solver (velocity) convergence tolerance, |residual|/|right-hand-side|.

  epscg_t       = 1.e-9              ! Solver (thermal conduction) convergence tolerance, |residual|/|right-hand-side|.

  epscg_potfld  = 1.e-9              ! Solver (potnetial fields) convergence tolerance, |residual|/|right-hand-side|.

  epscg_newflux = 1.e-9              ! Solver (boundary potential fields) convergence tolerance, |residual|/|right-hand-side|.

  epscg_divb    = 1.e-9              ! Solver (divergence cleaning) convergence tolerance, |residual|/|right-hand-side|.

  ncgmax = 100000                    ! Maximum solver iterations.
                                     ! If solver does not converge in ncgmax iterations,
                                     ! the code will exit with an error.
/
!
! Description of run should go here.
!
