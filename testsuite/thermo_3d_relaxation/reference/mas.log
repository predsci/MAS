  
 _|      _|     _|_|       _|_|_|
 _|_|  _|_|   _|    _|   _|
 _|  _|  _|   _|_|_|_|     _|_|
 _|      _|   _|    _|         _|
 _|      _|   _|    _|   _|_|_|
  
 Magnetohydrodynamic Algorithm outside a Sphere
                         Predictive Science Inc.

 ### Input file contents:

!
! *** Grid resolution.
!
&topology
  nr = 51
  nt = 31
  np = 61
/
&data
!
! *** Use the new style output text files.
!
  legacy_output_filenames = .false.
!
! *** Radial domain.
!
  r0 = 1.0
  r1 = 20.0
!
! *** Time domain.
!
  tmax = 0.5
!
! *** Grid specifications.
!
  rfrac    = 0.0,0.001,0.79,1.0
  drratio  = 3.0,1000.0,1.0
  nfrmesh  = 5
  tfrac    = 0.0,1.274212E-01,2.227219E-01,2.644975E-01,
             3.108777E-01,4.321008E-01,4.672269E-01,5.462185E-01,
             8.218487E-01,1.0
  dtratio  = 1.0,1.818182E-01,1.0,3.448276E-01,
             1.0,2.9,1.0,5.5,1.0
  nftmesh  = 5
  pfrac    = 0.0,2.651704E-01,3.522672E-01,3.635225E-01,
             3.743596E-01,3.961867E-01,4.090053E-01,4.206749E-01,
             5.095594E-01
  dpratio  = 1.0,1.333333E-01,1.0,5.000000E-01,
             1.0,2.0,1.0,7.5,1.0
  nfpmesh  = 5
  phishift = 0.0
!
! *** Time step specifications.
!
  dtmax = 0.01
  dtmin = 0.0001
  dt_init = 0.0
!
! *** Output options.
!
  plotlist = 't'
  ipltxint = 1
  tpltxint = 0.0
  slice_plotlist = 'rho'
  slice_tp_radii = 10.0
  slice_ixint = 1
  slice_txint = 0.0
  trace_txint = 0.0
  hdf32 = .false.
  rs_final = .false.
  trsdump = 0.0
!
! *** Model specification.
!
  advance_a    = .true.
  advance_v    = .true.
  advance_t    = .true.
  advance_rho  = .true.
  advance_pw   = .false.
  advance_zw   = .false.
  advance_fcs  = .false.
  trace_particles = .false.
  slund = 1.e6
  visc = 0.001
  gamma = 1.666666666666667
  g0 = 0.823
  br00 = 0.0
  rho0 = 20000.0
  tbc0    = 20000.
  tchromo = 20000.
  iftfloor = .true.
  tfloor  = 10000.
  char_bc0 = .true.
  char_bc1 = .true.
  ubzero = .true.
  filter_poles = .false.
! *** Thermal conduction:
  advance_tc = .true.
  tcond = 1.0
  t_cutoff1 = 250000.0
  nfilt_kappa = 0
  alpha_nocoll = 1.0
  tc_dr = 0.5
  tc_nocoll_dr = 0.5
! *** Radiative loss:
  radloss = 1.0
  rad_law = 'CHIANTI_v713_HYBRID'
! *** Heating:
  heatsource(1)%active = .true.
  heatsource(1)%name = 'QS'
  heatsource(1)%type = 'br-dependent'
  heatsource(1)%h0 = 0.044
  heatsource(1)%lambda = 0.2
  heatsource(1)%brmax = 0.25
  heatsource(1)%b_attenuation = .false.
  heatsource(1)%t_profile%active = .false.
  heatsource(1)%r_profile%active = .false.
  heatsource(1)%b_profile%active = .false.
  heatsource(2)%active = .true.
  heatsource(2)%name = 'AR'
  heatsource(2)%type = 'b-dependent'
  heatsource(2)%h0 = 0.18
  heatsource(2)%power = 1.2
  heatsource(2)%b_attenuation = .false.
  heatsource(2)%t_profile%active = .false.
  heatsource(2)%r_profile%active = .false.
  heatsource(2)%b_profile%active = .true.
  heatsource(2)%b_profile%f = 0.0,1.0,1.0
  heatsource(2)%b_profile%x = 8.2
  heatsource(2)%b_profile%w = 7.2,1.0
  heatsource(3)%active = .true.
  heatsource(3)%name = 'FW'
  heatsource(3)%type = 'exponential'
  heatsource(3)%h0 = 0.00184
  heatsource(3)%lambda = 0.7
  heatsource(3)%b_attenuation = .false.
  heatsource(3)%t_profile%active = .false.
  heatsource(3)%r_profile%active = .false.
  heatsource(3)%b_profile%active = .false.
!
! *** Initial condition.
!
  initial_field = 'POTENTIAL_FIELD'
  bnfile = 'br_input.h5'
  initial_plasma = '1dfile'
  onedfile = 'initial_plasma_1d_r.dat'
!
! *** Numerical algorithm options.
!
  cfl = 0.6
  use_sts_visc = .false.
  use_sts_tc   = .false.
  visc_auto_subcycle = .false.
  tc_auto_subcycle   = .false.
  ifimplrad = 0
  ifprec_t     = 3
  ifprec_v     = 3
  ifprec_pot2d = 3
  ifprec_divb  = 3
  epscg_a       = 1.e-9
  epscg_v       = 1.e-9
  epscg_t       = 1.e-9
  epscg_potfld  = 1.e-9
  epscg_newflux = 1.e-9
  epscg_divb    = 1.e-9
  ncgmax = 100000
/
!
! A 3D CME for a model field like the May 12, 1997 CME.
! The initial field is the sum of a sun-centered dipole
! and a sub-surface bipole to represent the active region.
!


Code: MAS
Version: 0.9.2.1git
Updated on: 04/23/2025
Source file: mas.F90
Run ID: mas
Run started on: 04/28/2025
Run started at: 15:32:13
Ran on machine: PREDSCI-GPU2
Machine type: x86_64
Compiler: GCC version 12.3.0
Compiler Flags: -I /opt/psi/gnu/ext_deps/deps/hdf5/include -I /usr/lib/x86_64-linux-gnu/openmpi/lib/../../fortran/gfortran-mod-15/openmpi -I /usr/lib/x86_64-linux-gnu/openmpi/lib -march=alderlake -mmmx -mpopcnt -msse -msse2 -msse3 -mssse3 -msse4.1 -msse4.2 -mavx -mavx2 -mno-sse4a -mno-fma4 -mno-xop -mfma -mno-avx512f -mbmi -mbmi2 -maes -mpclmul -mno-avx512vl -mno-avx512bw -mno-avx512dq -mno-avx512cd -mno-avx512er -mno-avx512pf -mno-avx512vbmi -mno-avx512ifma -mno-avx5124vnniw -mno-avx5124fmaps -mno-avx512vpopcntdq -mno-avx512vbmi2 -mgfni -mvpclmulqdq -mno-avx512vnni -mno-avx512bitalg -mno-avx512bf16 -mno-avx512vp2intersect -mno-3dnow -madx -mabm -mno-cldemote -mclflushopt -mclwb -mno-clzero -mcx16 -mno-enqcmd -mf16c -mfsgsbase -mfxsr -mno-hle -msahf -mno-lwp -mlzcnt -mmovbe -mmovdir64b -mmovdiri -mno-mwaitx -mno-pconfig -mpku -mno-prefetchwt1 -mprfchw -mptwrite -mrdpid -mrdrnd -mrdseed -mno-rtm -mserialize -mno-sgx -msha -mshstk -mno-tbm -mno-tsxldtrk -mvaes -mwaitpkg -mno-wbnoinvd -mxsave -mxsavec -mxsaveopt -mxsaves -mno-a


Total number of ranks =      4

Number of ranks in r =       2
Number of ranks in t =       1
Number of ranks in p =       2

Global mesh dimension in r =     51
Global mesh dimension in t =     31
Global mesh dimension in p =     61

Average # of mesh pts per rank in r =   25.5
Average # of mesh pts per rank in t =   31.0
Average # of mesh pts per rank in p =   30.5

Estimated load imbalance =   6.95 %

 >running

NTIME =        1, TIME =     0.010000, DTIME =     0.010000 (dtmx)
NTIME =        2, TIME =     0.020000, DTIME =     0.010000 (dtmx)
NTIME =        3, TIME =     0.030000, DTIME =     0.010000 (dtmx)
NTIME =        4, TIME =     0.040000, DTIME =     0.010000 (dtmx)
NTIME =        5, TIME =     0.050000, DTIME =     0.010000 (dtmx)
NTIME =        6, TIME =     0.060000, DTIME =     0.010000 (dtmx)
NTIME =        7, TIME =     0.070000, DTIME =     0.010000 (dtmx)
NTIME =        8, TIME =     0.080000, DTIME =     0.010000 (dtmx)
NTIME =        9, TIME =     0.090000, DTIME =     0.010000 (dtmx)
NTIME =       10, TIME =     0.100000, DTIME =     0.010000 (dtmx)
NTIME =       11, TIME =     0.110000, DTIME =     0.010000 (dtmx)
NTIME =       12, TIME =     0.120000, DTIME =     0.010000 (dtmx)
NTIME =       13, TIME =     0.130000, DTIME =     0.010000 (dtmx)
NTIME =       14, TIME =     0.140000, DTIME =     0.010000 (dtmx)
NTIME =       15, TIME =     0.150000, DTIME =     0.010000 (dtmx)
NTIME =       16, TIME =     0.160000, DTIME =     0.010000 (dtmx)
NTIME =       17, TIME =     0.170000, DTIME =     0.010000 (dtmx)
NTIME =       18, TIME =     0.180000, DTIME =     0.010000 (dtmx)
NTIME =       19, TIME =     0.190000, DTIME =     0.010000 (dtmx)
NTIME =       20, TIME =     0.200000, DTIME =     0.010000 (dtmx)
NTIME =       21, TIME =     0.210000, DTIME =     0.010000 (dtmx)
NTIME =       22, TIME =     0.220000, DTIME =     0.010000 (dtmx)
NTIME =       23, TIME =     0.230000, DTIME =     0.010000 (dtmx)
NTIME =       24, TIME =     0.240000, DTIME =     0.010000 (dtmx)
NTIME =       25, TIME =     0.250000, DTIME =     0.010000 (dtmx)
NTIME =       26, TIME =     0.260000, DTIME =     0.010000 (dtmx)
NTIME =       27, TIME =     0.270000, DTIME =     0.010000 (dtmx)
NTIME =       28, TIME =     0.280000, DTIME =     0.010000 (dtmx)
NTIME =       29, TIME =     0.290000, DTIME =     0.010000 (dtmx)
NTIME =       30, TIME =     0.300000, DTIME =     0.010000 (dtmx)
NTIME =       31, TIME =     0.310000, DTIME =     0.010000 (dtmx)
NTIME =       32, TIME =     0.320000, DTIME =     0.010000 (dtmx)
NTIME =       33, TIME =     0.330000, DTIME =     0.010000 (dtmx)
NTIME =       34, TIME =     0.340000, DTIME =     0.010000 (dtmx)
NTIME =       35, TIME =     0.350000, DTIME =     0.010000 (dtmx)
NTIME =       36, TIME =     0.360000, DTIME =     0.010000 (dtmx)
NTIME =       37, TIME =     0.370000, DTIME =     0.010000 (dtmx)
NTIME =       38, TIME =     0.380000, DTIME =     0.010000 (dtmx)
NTIME =       39, TIME =     0.390000, DTIME =     0.010000 (dtmx)
NTIME =       40, TIME =     0.400000, DTIME =     0.010000 (dtmx)
NTIME =       41, TIME =     0.410000, DTIME =     0.010000 (dtmx)
NTIME =       42, TIME =     0.420000, DTIME =     0.010000 (dtmx)
NTIME =       43, TIME =     0.430000, DTIME =     0.010000 (dtmx)
NTIME =       44, TIME =     0.440000, DTIME =     0.010000 (dtmx)
NTIME =       45, TIME =     0.450000, DTIME =     0.010000 (dtmx)
NTIME =       46, TIME =     0.460000, DTIME =     0.010000 (dtmx)
NTIME =       47, TIME =     0.470000, DTIME =     0.010000 (dtmx)
NTIME =       48, TIME =     0.480000, DTIME =     0.010000 (dtmx)
NTIME =       49, TIME =     0.490000, DTIME =     0.010000 (dtmx)
NTIME =       50, TIME =     0.500000, DTIME =     0.010000 (dtmx)

Code: MAS
Version: 0.9.2.1git
Updated on: 04/23/2025
Source file: mas.F90
Run ID: mas
Run ended on: 04/28/2025
Run ended at: 15:32:19
Ran on machine: PREDSCI-GPU2
Machine type: x86_64
Compiler: GCC version 12.3.0
Compiler Flags: -I /opt/psi/gnu/ext_deps/deps/hdf5/include -I /usr/lib/x86_64-linux-gnu/openmpi/lib/../../fortran/gfortran-mod-15/openmpi -I /usr/lib/x86_64-linux-gnu/openmpi/lib -march=alderlake -mmmx -mpopcnt -msse -msse2 -msse3 -mssse3 -msse4.1 -msse4.2 -mavx -mavx2 -mno-sse4a -mno-fma4 -mno-xop -mfma -mno-avx512f -mbmi -mbmi2 -maes -mpclmul -mno-avx512vl -mno-avx512bw -mno-avx512dq -mno-avx512cd -mno-avx512er -mno-avx512pf -mno-avx512vbmi -mno-avx512ifma -mno-avx5124vnniw -mno-avx5124fmaps -mno-avx512vpopcntdq -mno-avx512vbmi2 -mgfni -mvpclmulqdq -mno-avx512vnni -mno-avx512bitalg -mno-avx512bf16 -mno-avx512vp2intersect -mno-3dnow -madx -mabm -mno-cldemote -mclflushopt -mclwb -mno-clzero -mcx16 -mno-enqcmd -mf16c -mfsgsbase -mfxsr -mno-hle -msahf -mno-lwp -mlzcnt -mmovbe -mmovdir64b -mmovdiri -mno-mwaitx -mno-pconfig -mpku -mno-prefetchwt1 -mprfchw -mptwrite -mrdpid -mrdrnd -mrdseed -mno-rtm -mserialize -mno-sgx -msha -mshstk -mno-tbm -mno-tsxldtrk -mvaes -mwaitpkg -mno-wbnoinvd -mxsave -mxsavec -mxsaveopt -mxsaves -mno-a


 ### End of run ...

 NTIME =         50
 TIME =  5.0000000000E-01

 ### CPU time used (on IPROC0):         6.88 seconds

